## timout
### webhook
- Webhook URLs: test/poduction
- HTTP Method: POST
- Path: go
- Authentication: none
- Respond: Immediately
- Options: none

### Normalizes
- Mode: Manual Mapping
- Fields to Set
```bash
# indentificação da mensagem que chega dentro do n8n
String: message.id = 3A29B1638B86BC6E7422
{{ $json.body.data.key.id || '' }}
***************************************************************
# indentificação do numero do telefone do cliente que chega dentro do n8n
String: message.remoteJid = 558399126797
{{ $json.body.data.key.remoteJid.split('@')[0] || '' }}
***************************************************************
# indentificação todos os tipos de mensagem que chega dentro do n8n
String: message.type = text
{{ $('start').item.json.body.data.message.extendedTextMessage ? 'text' : '' }}
{{ $('start').item.json.body.data.message.conversation ? 'text' : '' }}
{{ $('start').item.json.body.data.message.audioMessage ? 'audio' : '' }}
{{ $('start').item.json.body.data.message.imageMessage ? 'image' : '' }}
***************************************************************
# indentificação o conteudo da mensagem que chega dentro do n8n
String: content = Olá
{{ $('start').item.json.body.data.message.extendedTextMessage?.text || '' }}
{{ $('start').item.json.body.data.message.imageMessage?.caption || '' }}
{{ $('start').item.json.body.data.message.conversation || '' }}
***************************************************************
# indentificação a data que url chegou a mensagem que chega dentro do n8n
String: content.moment = data atual
{{ $('start').item.json.body.data.messageTimestamp.toDateTime('s').toISO() }}
***************************************************************
# indentificação se e um audio ou uma imagem da mensagem que chega dentro do n8n
String: content.url = 
{{ $('start').item.json.body.data.message.audioMessage?.url || '' }}
{{ $('start').item.json.body.data.message.imageMessage?.url || '' }}
***************************************************************
# indentificação se e uma mendagem de entrada(incoming) o saida(outcoming) da mensagem que chega dentro do n8n
String: content.event = incoming
{{ $('start').item.json.body.data.key.fromMe ? 'outcoming' : 'incoming' }}
***************************************************************
# indentificação o nome da instacia da mensagem que chega dentro do n8n
String: instance.name = surb-letty
{{ $json.body.instance }}
***************************************************************
# indentificação a apikey do n8n da mensagem que chega dentro do n8n
String: instance.evo.url = 47372FC06FED-4AD7-80F8-4A0DE3391C73
{{ $json.body.apikey }}
***************************************************************
# indentificação a url da evolution da mensagem que chega dentro do n8n
String: instance.evo_url = https://evo.surb.com.br
{{ $json.body.evo_url }}
***************************************************************
# indentificação a apikey do elevenlabs da mensagem que chega dentro do n8n
String: elevenlabs.key = sk_24c5816f10ebf863b5c81f7d07949ab30e94360e9
{{ $json.body.data.key.id || '' }}

- block 01
message.id
message.remoteJid
message.type
content
content.moment
content.url
content.event
instance.evo.name
instance.evo.key
instance.evo.url
elevenlabs.key
chat

- block 02
push.data
can
cannnot
```

### Origem Shwite
- Mode: Roles
- Routing Rules
```bash
{{ $json.message.event }}
is equal to
outcoming
Rename Output
Output Name = outcoming
***************************************************************
{{ $json.message.event }}
is equal to
incoming
Rename Output
Output Name = incoming
***************************************************************
```

### Get Block Chat Id Redis
- Credential to connect with: Redis Api
- Operation: GET
- Name: chat

```bash
fx: Key = 558399126797_timeout
{{ $json.message.chat_id }}_timeout
***************************************************************
Key Type: Automatic
```

### Gera Timeout Redis
- Credential to connect with: Redis Api
- Operation: SET

```bash
fx: Key = 558399126797_timeout
{{ $json.message.chat_id }}_timeout
***************************************************************
Value: true
Key Type: String
Expire: true
TTL: 900
```

### Switch Block
- Mode: Roles
- Routing Rules
```bash
{{ $json.chat }}
is empty
Rename Output
Output Name = can
***************************************************************
{{ $json.block }}
is equal to
true
Rename Output
Output Name = canot
***************************************************************
```

### No Operation